<div class="container-fluid">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <!-- Header -->
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="text-primary">
          <i class="bi bi-plus-circle me-2" *ngIf="!productId"></i>
          <i class="bi bi-pencil me-2" *ngIf="productId"></i>
          {{ productId ? 'Editar Producto' : 'Nuevo Producto' }}
        </h2>
        <a routerLink="/products" class="btn btn-outline-secondary">
          <i class="bi bi-arrow-left me-1"></i>Volver
        </a>
      </div>

      <!-- Form Card -->
      <div class="card shadow-sm">
        <div class="card-body">
          <form [formGroup]="productForm" (ngSubmit)="onSubmit()" class="needs-validation" novalidate>
            
            <!-- Alert Messages -->
            <div class="alert alert-success" *ngIf="successMessage">
              <i class="bi bi-check-circle-fill me-2"></i>{{ successMessage }}
            </div>
            
            <div class="alert alert-danger" *ngIf="errorMessage">
              <i class="bi bi-exclamation-circle-fill me-2"></i>{{ errorMessage }}
            </div>

            <div class="row">
              <!-- Image Preview -->
              <div class="col-md-4 mb-3">
                <div class="text-center">
                  <img [src]="productForm.get('imageUrl')?.value || 'https://via.placeholder.com/200'" 
                       alt="Preview" class="img-fluid rounded shadow" style="max-height: 200px;">
                  <div class="mt-2">
                    <label class="btn btn-outline-primary btn-sm">
                      <i class="bi bi-upload me-1"></i>Seleccionar Imagen
                      <input type="file" hidden (change)="onImageSelected($event)">
                    </label>
                  </div>
                </div>
              </div>

              <!-- Form Fields -->
              <div class="col-md-8">
                <div class="row">
                  <!-- Name -->
                  <div class="col-md-6 mb-3">
                    <label for="name" class="form-label">Nombre del Producto *</label>
                    <input type="text" class="form-control" id="name" formControlName="name" 
                           [class.is-invalid]="productForm.get('name')?.invalid && productForm.get('name')?.touched">
                    <div class="invalid-feedback">
                      El nombre es requerido y debe tener al menos 3 caracteres.
                    </div>
                  </div>

                  <!-- Category -->
                  <div class="col-md-6 mb-3">
                    <label for="category" class="form-label">Categoría *</label>
                    <select class="form-select" id="category" formControlName="category"
                            [class.is-invalid]="productForm.get('category')?.invalid && productForm.get('category')?.touched">
                      <option value="">Seleccionar categoría...</option>
                      <option value="Tecnología">Tecnología</option>
                      <option value="Electrodomésticos">Electrodomésticos</option>
                      <option value="Ropa">Ropa</option>
                      <option value="Alimentos">Alimentos</option>
                      <option value="Deportes">Deportes</option>
                    </select>
                    <div class="invalid-feedback">
                      Por favor selecciona una categoría.
                    </div>
                  </div>
                </div>

                <!-- Description -->
                <div class="mb-3">
                  <label for="description" class="form-label">Descripción *</label>
                  <textarea class="form-control" id="description" rows="3" formControlName="description"
                            [class.is-invalid]="productForm.get('description')?.invalid && productForm.get('description')?.touched"></textarea>
                  <div class="invalid-feedback">
                    La descripción es requerida y debe tener al menos 10 caracteres.
                  </div>
                </div>

                <div class="row">
                  <!-- Price -->
                  <div class="col-md-4 mb-3">
                    <label for="price" class="form-label">Precio ($) *</label>
                    <div class="input-group">
                      <span class="input-group-text">$</span>
                      <input type="number" class="form-control" id="price" formControlName="price" step="0.01"
                             [class.is-invalid]="productForm.get('price')?.invalid && productForm.get('price')?.touched">
                    </div>
                    <div class="invalid-feedback">
                      El precio debe ser mayor a 0.
                    </div>
                  </div>

                  <!-- Stock -->
                  <div class="col-md-4 mb-3">
                    <label for="stock" class="form-label">Stock *</label>
                    <input type="number" class="form-control" id="stock" formControlName="stock"
                           [class.is-invalid]="productForm.get('stock')?.invalid && productForm.get('stock')?.touched">
                    <div class="invalid-feedback">
                      El stock no puede ser negativo.
                    </div>
                  </div>

                  <!-- Image URL -->
                  <div class="col-md-4 mb-3">
                    <label for="imageUrl" class="form-label">URL de Imagen</label>
                    <input type="string" class="form-control" id="imageUrl" formControlName="imageUrl"
                           placeholder="https://ejemplo.com/imagen.jpg">
                  </div>
                </div>
              </div>
            </div>

            <!-- Form Actions -->
            <div class="d-flex justify-content-between pt-3 border-top">
              <button type="button" class="btn btn-outline-secondary" routerLink="/products">
                <i class="bi bi-x-circle me-1"></i>Cancelar
              </button>
              <button type="submit" class="btn btn-primary" [disabled]="productForm.invalid">
                <i class="bi bi-check-circle me-1"></i>
                {{ productId ? 'Actualizar Producto' : 'Crear Producto' }}
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>